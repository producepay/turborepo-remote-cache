import closeWithGrace from 'close-with-grace';
import { createApp } from './app.js';
import { env } from './env.js';
const app = createApp({
    trustProxy: true,
    bodyLimit: 52428800,
});
closeWithGrace({ delay: 10000 }, async function ({ err, signal }) {
    if (err) {
        app.log.error(err);
    }
    app.log.info(`[${signal}] Gracefully closing the server instance.`);
    await app.close();
});
app.listen({ host: '0.0.0.0', port: env.get().PORT }, (err) => {
    if (err) {
        app.log.error(err);
        process.exit(1);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxjQUFjLE1BQU0sa0JBQWtCLENBQUE7QUFFN0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUNwQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBRTlCLE1BQU0sR0FBRyxHQUFHLFNBQVMsQ0FBQztJQUNwQixVQUFVLEVBQUUsSUFBSTtJQUtoQixTQUFTLEVBQUUsUUFBUTtDQUNwQixDQUFDLENBQUE7QUFFRixjQUFjLENBQ1osRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQ2hCLEtBQUssV0FBVyxFQUFFLEdBQUcsRUFBRSxNQUFNLEVBQW9DO0lBQy9ELElBQUksR0FBRyxFQUFFLENBQUM7UUFDUixHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtJQUNwQixDQUFDO0lBRUQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLDJDQUEyQyxDQUFDLENBQUE7SUFFbkUsTUFBTSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUE7QUFDbkIsQ0FBQyxDQUNGLENBQUE7QUFFRCxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUU7SUFDNUQsSUFBSSxHQUFHLEVBQUUsQ0FBQztRQUNSLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO1FBQ2xCLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUE7SUFDakIsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFBIn0=